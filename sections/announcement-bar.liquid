{%- comment -%}
  Section: Announcement Bar
  Dismissible top banner for promotions
{%- endcomment -%}

{%- if section.settings.show_announcement -%}
{%- style -%}
  .announcement-bar {
    background: {{ section.settings.bar_color }};
    color: {{ section.settings.text_color }};
    text-align: center;
    padding: 10px 24px;
    font-size: 12px;
    font-weight: var(--font-weight-semibold);
    letter-spacing: 0.1em;
    text-transform: uppercase;
    position: relative;
    overflow: hidden;
  }

  .announcement-bar a {
    color: inherit;
    text-decoration: underline;
    text-underline-offset: 3px;
  }

  .announcement-bar__close {
    position: absolute;
    right: 16px;
    top: 50%;
    transform: translateY(-50%);
    color: inherit;
    opacity: 0.6;
    padding: 4px;
    transition: opacity var(--duration-fast);
  }

  .announcement-bar__close:hover {
    opacity: 1;
  }

  .announcement-bar__text {
    animation: marquee {{ section.settings.scroll_speed }}s linear infinite;
    white-space: nowrap;
  }

  @keyframes marquee {
    0% { transform: translateX(100%); }
    100% { transform: translateX(-100%); }
  }

  .announcement-bar--static .announcement-bar__text {
    animation: none;
  }
{%- endstyle -%}

<div
  class="announcement-bar {% unless section.settings.scroll_text %}announcement-bar--static{% endunless %}"
  id="AnnouncementBar"
  data-section-id="{{ section.id }}"
>
  <span class="announcement-bar__text">
    {%- if section.settings.link != blank -%}
      <a href="{{ section.settings.link }}">{{ section.settings.text }}</a>
    {%- else -%}
      {{ section.settings.text }}
    {%- endif -%}
  </span>

  {%- if section.settings.dismissible -%}
    <button class="announcement-bar__close" id="AnnouncementClose" aria-label="{{ 'general.close' | t }}">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M18 6L6 18M6 6l12 12"/>
      </svg>
    </button>
  {%- endif -%}
</div>
{%- endif -%}

{% schema %}
{
  "name": "Announcement Bar",
  "class": "section-announcement",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_announcement",
      "label": "Show announcement bar",
      "default": true
    },
    {
      "type": "text",
      "id": "text",
      "label": "Announcement text",
      "default": "✨ Free shipping on all orders above ₹2000 — Handcrafted with love"
    },
    {
      "type": "url",
      "id": "link",
      "label": "Link (optional)"
    },
    {
      "type": "color",
      "id": "bar_color",
      "label": "Background color",
      "default": "#2D2D2D"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#FDFCF9"
    },
    {
      "type": "checkbox",
      "id": "scroll_text",
      "label": "Enable scrolling text",
      "default": false
    },
    {
      "type": "range",
      "id": "scroll_speed",
      "label": "Scroll speed",
      "min": 10,
      "max": 40,
      "step": 5,
      "default": 20,
      "unit": "s"
    },
    {
      "type": "checkbox",
      "id": "dismissible",
      "label": "Allow dismissal",
      "default": true
    }
  ]
}
{% endschema %}
